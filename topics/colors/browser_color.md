# Color in browser engines

## Color library ideas

- `Object.prototype.valueOf` for comparisons
- Maintain registry of CSS2 system colors, currentColor, and color variables to
  use when comparing. When not set, they aren't comparable. A variable is always
  equivalent to itself.
- Since `currentColor` is dependent on element, should it ever compare equal?
- Allow loading of CSS2 system colors from browser colors

## Engines

### Webkit

Functions from [CSS source](https://github.com/WebKit/webkit/tree/main/Source/WebCore/css):
- `red`
- `green`
- `blue`
- `alpha`

Functions from [`StyleColor.cpp` source](https://github.com/WebKit/webkit/blob/main/Source/WebCore/css/StyleColor.cpp):
- `isCurrentColor`
- `colorFromKeyword`
- `isColorKeyword`
- `isSystemColor`

The enum for CSS color keywords and other CSS values is generated by
[process-css-values.py](https://github.com/WebKit/WebKit/blob/fc4da4586f6bbfa2bed7a25a4e8e3f4f6007c596/Source/WebCore/css/process-css-values.py#L318)
(formerly [makevalues.pl](https://github.com/WebKit/webkit/blob/017574a4e19bb7dfb6793c13510f30020aad2cdf/Source/WebCore/css/makevalues.pl#L171)),
with data from [CSSValueKeywords.in](https://github.com/WebKit/webkit/blob/fc4da4586f6bbfa2bed7a25a4e8e3f4f6007c596/Source/WebCore/css/CSSValueKeywords.in#L189).

### Mozilla

[Color CSS data type](https://developer.mozilla.org/en-US/docs/Web/CSS/color_value):

- HTML only recognizes the 16 basic color keywords found in CSS1, using a
  specific algorithm to convert unrecognized values (often to completely
  different colors). The other color keywords should only be used in CSS and
  SVG.
- Unlike HTML, CSS will completely ignore unknown keywords.
- The color keywords all represent plain, solid colors, without transparency.
- Several keywords are aliases for each other:
- Though many keywords have been adapted from X11, their RGB values may differ
  from the corresponding color on X11 systems since manufacturers sometimes
  tailor X11 colors to their specific hardware.
- Also has:
  - Mozilla System Color Extensions
  - Mozilla Color Preference Extensions

### Chrome

[Quick Color Management System](https://github.com/jrmuizel/qcms) is used
[in Chrome](chrome://credits/) and [Firefox](https://hg.mozilla.org/mozilla-central/file/tip/gfx/qcms).

Blink
- [`WebColorName.cpp`](https://chromium.googlesource.com/chromium/blink/+/main/Source/web/WebColorName.cpp)

## CSSWG

- Consider [default color value](https://github.com/w3c/csswg-drafts/issues/1851)
- [Inheritance of currentColor](https://github.com/w3c/csswg-drafts/issues/1510)
- [Interpolating between color spaces](https://github.com/w3c/csswg-drafts/issues/883)
